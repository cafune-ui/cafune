{"version":3,"sources":["webpack:///../components/toast/index.jsx","webpack:///./pages/components/toast/index.js"],"names":["seed","getUuid","type","now","Date","notifyContainerNode","durationDefault","ToastList","Toast","props","uid","comp","clearCloseTimer","closeTimer","clearTimeout","componentDidMount","duration","setTimeout","close","componentWillUnmount","render","prefix","icon","content","shouldClose","toastIcon","size","Component","show","success","error","loading","hide","defaultProps","multiple","state","onClose","setState","node","cleanTimer","createNotifyContainerNode","notifyContainerClass","document","querySelector","bodyNode","body","div","createElement","className","appendChild","isBrowser","toast","toastid","i","ToastComp","showToast","kind","mutiple","alert"],"mappings":"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","file":"9.chunk.993c7.js","sourcesContent":["import { render, Component } from 'preact';\nimport PropTypes from 'prop-types';\nimport Icon from '../icon';\nimport { isBrowser } from '../../util/isomorphic';\nlet seed = 0;\nfunction getUuid(type) {\n  const now = Date.now();\n  return `cToast_${type}_${now}_${seed++}`;\n}\nlet notifyContainerNode;\nconst durationDefault = 2000;\nconst ToastList = {};\n// const browserPrefixs = ['-webkit-', '-moz-', '-o-', ''];\n/**\n * 消息提示\n * @example\n * - 不同类型提示\n *\n *  ```js\n *  Toast.show({ content: 'show' });\n *  Toast.success({ content: 'success' });\n *\n *  Toast.error({ content: 'error' });\n *\n *  Toast.loading({ content: 'loading' });\n *  ```\n * - 自定义时长提示\n *\n *  ```javascript\n *  Toast.show({ content: '3秒之后消失', duration: 3000 })\n *  ```\n * - 带回调函数提示\n *\n *  ```javascript\n *  Toast.show({ content: '弹出消失alert', onClose() { alert('消失！') } })\n *  ```\n * - 自定义取消Toast\n * 当 duration 为0时，toast 需要调用`hide` 方法才能让toast 消失，loading 方法默认duration 为0\n *\n *  ```javascript\n * const toast = Toast.loading({ content: '弹出消失alert', onClose() { alert('消失！') } });\n * Toast.hide(toast);\n * ```\n */\n\nclass Toast extends Component {\n  static show = show;\n  static success = success;\n  static error = error;\n  static loading = loading;\n  static hide = hide;\n  static propTypes = {\n    /**\n     * 提示内容\n     */\n    content: PropTypes.string.isRequired,\n    /**\n     * 提示时长(ms)，默认为2000ms\n     */\n    duration: PropTypes.number,\n    /**\n     * 自定义图标\n      */\n    icon: PropTypes.oneOfType([PropTypes.string, PropTypes.shape({\n      icon: PropTypes.string,\n      size: PropTypes.string\n    })]),\n    /**\n     * toast 类型\n     */\n    type: PropTypes.oneOf(['normal', 'success', 'error', 'loading']),\n    /**\n     * 消失时回调函数\n     */\n    onClose: PropTypes.func,\n    /**\n     * 是否只显示一个toast，默认为false(`suceess` & `error` & `'loading'` 下默认为true)，将依次显示toast\n     */\n    multiple: PropTypes.bool\n  };\n  static defaultProps = {\n    duration: 2000,\n    type: 'normal',\n    multiple: false,\n    prefix: 'caf-toast'\n  };\n  constructor(props) {\n    super(props);\n    const { uid } = this.props;\n    ToastList[uid] = { comp: this };\n  }\n  state = {\n    shouldClose: false\n  };\n  closeTimer;\n  cleanTimer;\n  close = () => {\n    const { onClose, uid } = this.props;\n    if (ToastList[uid]) {\n      this.clearCloseTimer();\n      this.setState({\n        shouldClose: true\n      });\n      onClose && onClose();\n      const node = ToastList[uid].node;\n      delete ToastList[uid];\n      /* istanbul ignore next */\n      this.cleanTimer = setTimeout(() => {\n        /* istanbul ignore else */\n        if (notifyContainerNode) {\n          render('', notifyContainerNode, node);\n        }\n        clearTimeout(this.cleanTimer);\n        this.cleanTimer = null;\n      }, 600);\n    }\n  };\n  clearCloseTimer() {\n    if (this.closeTimer) {\n      clearTimeout(this.closeTimer);\n      this.closeTimer = null;\n    }\n  }\n  componentDidMount() {\n    const { duration = durationDefault } = this.props;\n    if (duration > 0) {\n      this.closeTimer = setTimeout(() => {\n        this.close();\n      }, duration);\n    }\n  }\n  componentWillUnmount() {\n    this.clearCloseTimer();\n  }\n  render({ prefix, icon, content, type }, { shouldClose }) {\n    let toastIcon = null;\n    if (icon) {\n      if (typeof icon === 'string') {\n        toastIcon = <Icon icon={icon} size=\"42px\" />\n      } else if (icon.icon){\n        toastIcon = <Icon icon={icon.icon} size={icon.size || '42px'} />\n      }\n    }\n    return (\n      <div\n        className={prefix}\n        data-type={type}\n        data-status={shouldClose ? 0 : 1}\n      >\n        {toastIcon}\n        <p className={`${prefix}-content`}>{content}</p>\n      </div>\n    );\n  }\n}\n/**\n * 创建toast 容器\n */\nconst createNotifyContainerNode = () => {\n  let notifyContainerClass = 'caf-notify';\n  let notifyContainerNode = document.querySelector(`.${notifyContainerClass}`);\n\n  if (!notifyContainerNode) {\n    const bodyNode = document.body;\n    const div = document.createElement('div');\n    div.className = notifyContainerClass;\n    notifyContainerNode = bodyNode.appendChild(div);\n  }\n\n  return notifyContainerNode;\n};\n\n/**\n * 基础Toast（不包含图标\n */\nfunction show({\n  content,\n  duration = durationDefault,\n  icon,\n  type = 'normal',\n  onClose,\n  multiple = false\n}) {\n  if (!isBrowser) return null;\n  notifyContainerNode = createNotifyContainerNode();\n  if (!multiple) {\n    // notifyContainerNode.innerHTML = '';\n    hide();\n  }\n  const uid = getUuid(type);\n  const props = {\n    content,\n    icon,\n    duration,\n    onClose,\n    type,\n    uid\n  };\n  let toast = render(<Toast {...props} />, notifyContainerNode);\n  ToastList[uid].node = toast;\n  return uid;\n}\n/**\n * 成功Toast\n */\nfunction success({ content, duration, icon = 'success', onClose } = {}) {\n  return show({ content, duration, icon, type: 'success', onClose });\n}\n/**\n * 失败Toast\n */\nfunction error({ content, duration, icon = 'error', onClose } = {}) {\n  return show({ content, duration, icon, type: 'error', onClose });\n}\n\n/**\n * 加载中Toast\n */\nfunction loading({ content = '加载中', duration = 0, onClose } = {}) {\n  return show({ content, duration, type: 'loading', onClose });\n}\n\nfunction hide(toastid) {\n  if (!isBrowser) return null;\n  if (toastid && ToastList[toastid]) {\n    ToastList[toastid].comp.close(true);\n  } else {\n    for (const i in ToastList) {\n      ToastList[i].comp.close(true);\n    }\n  }\n}\n\n// export const Toast = {\n//   show,\n//   success,\n//   error,\n//   loading,\n//   hide\n// };\n\nexport default Toast;\n\n\n\n// WEBPACK FOOTER //\n// ../components/toast/index.jsx","import { Toast, Button } from 'cafune';\nimport { Component } from 'preact';\nexport default class ToastComp extends Component {\n  showToast = ({ kind = 'show', duration, icon, onClose, mutiple } = {}) => {\n    return () => {\n      Toast[kind]({\n        content: kind,\n        duration,\n        icon,\n        onClose,\n        mutiple\n      });\n    };\n  };\n  render() {\n    return (\n      <div>\n        <div class=\"caf-demo-block\">\n          <p class=\"caf-demo-title\">toast 类型</p>\n          <Button onClick={this.showToast()}>常规Toast</Button>\n          <Button onClick={this.showToast({ kind: 'loading' })}>\n            加载Toast\n          </Button>\n          <Button type=\"warning\" onClick={this.showToast({ kind: 'error' })}>\n            错误Toast\n          </Button>\n          <Button type=\"primary\" onClick={this.showToast({ kind: 'success' })}>\n            成功Toast\n          </Button>\n        </div>\n        <div class=\"caf-demo-block\">\n          <p class=\"caf-demo-title\">定义时长</p>\n          <Button onClick={this.showToast({ duration: 4000 })}>\n            自定义时长<p class=\"caf-demo-button-desc\">(4s)</p>\n          </Button>\n        </div>\n        <div class=\"caf-demo-block\">\n          <p class=\"caf-demo-title\">定义关闭回调</p>\n          <Button\n            onClick={this.showToast({\n              onClose() {\n                alert('关闭');\n              }\n            })}\n          >\n            回调\n          </Button>\n        </div>\n        <div class=\"caf-demo-block\">\n          <p class=\"caf-demo-title\">定义图标</p>\n          <Button\n            onClick={this.showToast({\n              icon: 'like'\n            })}\n          >\n            内置图标\n          </Button>\n          <Button\n            onClick={this.showToast({\n              icon: {\n                icon:\n                  'https://image.flaticon.com/icons/png/128/2026/2026462.png',\n                size: '32px'\n              }\n            })}\n          >\n            图片图标\n          </Button>\n        </div>\n      </div>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./pages/components/toast/index.js"],"sourceRoot":""}