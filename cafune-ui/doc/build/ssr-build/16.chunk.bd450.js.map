{"version":3,"sources":["webpack:///../components/search-bar/index.jsx","webpack:///./pages/components/search-bar/index.js"],"names":["actionDefault","confirm","text","keepShow","cancel","custom","onNextFrame","cb","window","requestAnimationFrame","setTimeout","clearNextFrameAction","nextFrameId","cancelAnimationFrame","clearTimeout","SearchBar","props","value","state","focus","componentWillReceiveProps","nextProps","setState","componentDidMount","componentDidUpdate","actionRef","current","action","type","$actionBtn","actionStyle","getComputedStyle","actionSize","offsetWidth","parseInt","marginLeft","style","componentWillUnmount","onBlurTimeout","render","prefix","className","placeholder","maxLength","leftIcon","restProps","isBtnHide","cx","onConfirm","onChange","onFocus","onBlur","inputRef","onCancel","onClick","marginRight","Component","defaultProps","align","clear","e","target","preventDefault","val","blurFromOnClear","document","activeElement","createRef","formRef","SearchBarComp","focusInput","inpRef","alert","console","log","c"],"mappings":"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","file":"16.chunk.bd450.js","sourcesContent":["import { Component, createRef } from 'preact';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport Icon from '../icon';\n\nconst actionDefault = {\n  confirm: {\n    text: '搜索',\n    keepShow: true\n  },\n  cancel: {\n    text: '取消',\n    keepShow: false\n  },\n  custom: {\n    text: '确定',\n    keepShow: true\n  }\n};\nfunction onNextFrame(cb) {\n  if (window.requestAnimationFrame) {\n    return window.requestAnimationFrame(cb);\n  }\n  return window.setTimeout(cb, 1);\n}\nfunction clearNextFrameAction(nextFrameId) {\n  if (window.cancelAnimationFrame) {\n    window.cancelAnimationFrame(nextFrameId);\n  } else {\n    window.clearTimeout(nextFrameId);\n  }\n}\n\n/**\n * 搜索栏\n */\nclass SearchBar extends Component {\n  static defaultProps = {\n    prefix: 'caf-search',\n    align: 'center',\n    leftIcon: 'search'\n  };\n  static propTypes = {\n    /**\n     * 自定义类名\n     */\n    prefix: PropTypes.string,\n    /**\n     * 搜索框的\n     */\n    /**\n     * 占位文字\n     */\n    placeholder: PropTypes.string,\n    /**\n     * 最多可允许输入字符个数\n     */\n    maxLength: PropTypes.number,\n    /**\n     * 确定搜索时回调，支持`enter` 触发\n     */\n    onConfirm: PropTypes.func,\n    /**\n     * 取消操作时回调\n     */\n    onCancel: PropTypes.func,\n    /**\n     * 内容变更时回调\n     */\n    onChange: PropTypes.func,\n    /**\n     * 左侧按钮图标（参考 `Icon` 组件）\n     */\n    leftIcon: PropTypes.string,\n    /**\n     * 搜索框右侧附加功能\n     */\n    addition: PropTypes.shape({\n      /**\n       * 附加功能按钮\n       */\n      icon: PropTypes.string,\n      /**\n       * 附加功能点击事件\n       */\n      onClick: PropTypes.func\n    }),\n    /**\n     * 右侧功能按钮\n     */\n    action: PropTypes.shape({\n      /**\n       * 按钮类型\n       */\n      type: PropTypes.oneOf(['confirm', 'cancel', 'custom']),\n      /**\n       * 按钮文字\n       */\n      text: PropTypes.string,\n      /**\n       * 是否一直显示\n       */\n      keepShow: PropTypes.bool,\n      /**\n       * 功能按钮点击事件，默认情况下，点击时，`actionType`为`confirm`时会额外触发`onConfirm`事件，为`cancel`时会额外触发`onCancel`事件\n       */\n      onClick: PropTypes.func\n    })\n  };\n  constructor(props) {\n    super(props);\n    const value = props.value || '';\n    this.state = {\n      value,\n      focus: false\n    };\n  }\n  componentWillReceiveProps(nextProps) {\n    if ('value' in nextProps && nextProps.value !== this.state.value) {\n      this.setState({\n        value: nextProps.value\n      });\n    }\n  }\n  actionSize = 0;\n  componentDidMount() {\n    this.componentDidUpdate();\n  }\n  componentDidUpdate() {\n    if (this.actionRef && this.actionRef.current) {\n      let { action } = this.props;\n      action = Object.assign({}, actionDefault[action.type], action);\n      const { focus } = this.state;\n      if (!action.keepShow && !focus) {\n        const $actionBtn = this.actionRef.current;\n        const actionStyle = window.getComputedStyle($actionBtn);\n        const actionSize =\n          $actionBtn.offsetWidth + parseInt(actionStyle.marginLeft, 10);\n        $actionBtn.style = `margin-right: ${-1 * actionSize}px`;\n        this.actionSize = actionSize;\n      }\n    }\n  }\n  onBlurTimeout;\n  componentWillUnmount() {\n    if (this.onBlurTimeout) {\n      clearNextFrameAction(this.onBlurTimeout);\n      this.onBlurTimeout = null;\n    }\n  }\n  clear = () => {\n    if (!('value' in this.props)) {\n      this.setState({ value: '' });\n    }\n    if (this.props.onChange) {\n      this.props.onChange('');\n    }\n  };\n  onChange = e => {\n    const value = e.target.value;\n    if (!('value' in this.props)) {\n      this.setState({ value });\n    }\n    if (this.props.onChange) {\n      this.props.onChange(value);\n    }\n  };\n  onConfirm = e => {\n    e && e.preventDefault();\n    let val = '';\n     if (this.inputRef && this.inputRef.current) {\n      val = this.inputRef.current.value;\n    } else {\n      val = this.state.value;\n    }\n    this.props.onConfirm && this.props.onConfirm(val);\n  };\n  onCancel = () => {\n    if (this.props.onCancel) {\n      this.props.onCancel(this.state.value || '');\n    } else {\n      this.clear();\n    }\n  };\n  onFocus = () => {\n    this.setState({\n      focus: true\n    });\n  };\n  onBlur = () => {\n    this.onBlurTimeout = onNextFrame(() => {\n      if (!this.blurFromOnClear) {\n        if (document.activeElement !== this.inputRef) {\n          this.setState({\n            focus: false\n          });\n        }\n      }\n      this.blurFromOnClear = false;\n    });\n  };\n  focus = () => {\n    if (this.inputRef && this.inputRef.current) {\n      this.inputRef.current.focus();\n    }\n  };\n  inputRef = createRef();\n  actionRef = createRef();\n  formRef = createRef();\n  render(\n    { prefix, className, placeholder, maxLength, action, leftIcon, ...restProps },\n    { value, focus }\n  ) {\n    let isBtnHide = false;\n    if (action) {\n      action = Object.assign({}, actionDefault[action.type], action);\n      isBtnHide = !action.keepShow && !focus;\n    }\n    return (\n      <form\n        className={cx(prefix, className)}\n        onSubmit={this.onConfirm}\n        {...restProps}\n      >\n        <div className={`${prefix}-input`}>\n          <Icon icon={leftIcon} />\n          <input\n            type=\"search\"\n            placeholder={placeholder}\n            value={value}\n            maxLength={maxLength}\n            onChange={this.onChange}\n            onFocus={this.onFocus}\n            onBlur={this.onBlur}\n            ref={this.inputRef}\n          />\n        </div>\n        {!!action && (\n          <div\n            className={cx(`${prefix}-action`, {\n              [`${prefix}-action__hide`]: isBtnHide\n            })}\n            onClick={() => {\n              if (action.type === 'cancel') {\n                this.onCancel()\n              } else if (action.type === 'confirm') {\n                this.onConfirm();\n              }\n              action.onClick();\n            }}\n            style={{ marginRight: isBtnHide ? `${this.actionSize * -1}px` : 0 }}\n            ref={this.actionRef}\n          >\n            {action.text}\n          </div>\n        )}\n      </form>\n    );\n  }\n}\nexport default SearchBar;\n\n\n\n// WEBPACK FOOTER //\n// ../components/search-bar/index.jsx","import { SearchBar } from 'cafune';\nimport { Component } from 'preact';\nexport default class SearchBarComp extends Component {\n  state = {\n    val: '关键词'\n  };\n  focusInput = () => {\n    this.inpRef.focus();\n  };\n  render({}, { val }) {\n    return (\n      <div>\n        <div>\n          <p class=\"caf-demo-title\">默认用法</p>\n          <SearchBar placeholder=\"请输入关键词\" />\n        </div>\n        <div>\n          <p class=\"caf-demo-title\">自定义值</p>\n          <SearchBar\n            placeholder=\"请输入关键词\"\n            value={val}\n            onChange={val => this.setState({ val })}\n          />\n        </div>\n        <div>\n          <p class=\"caf-demo-title\">设置回调</p>\n          <SearchBar\n            placeholder=\"请输入关键词\"\n            onConfirm={val => alert(`确认，输入值为${val}`)}\n            onChange={val => console.log(val)}\n          />\n        </div>\n        <div>\n          <p class=\"caf-demo-title\">定义右侧按钮</p>\n          <SearchBar\n            placeholder=\"请输入关键词\"\n            onConfirm={() => alert('确认')}\n            onCancel={() => alert('取消')}\n            action={{\n              type: 'cancel',\n              onClick() {\n                console.log('action cancel');\n              }\n            }}\n          />\n          <SearchBar\n            placeholder=\"请输入关键词\"\n            onConfirm={val => alert(val)}\n            onCancel={() => alert('取消')}\n            action={{\n              type: 'confirm',\n              onClick() {\n                console.log('action confirm');\n              }\n            }}\n          />\n          <SearchBar\n            placeholder=\"请输入关键词\"\n            onConfirm={() => alert('确认')}\n            onCancel={() => alert('取消')}\n            action={{\n              type: 'custom',\n              text: '试试手气',\n              keepShow: false,\n              onClick() {\n                alert('试试手气');\n              }\n            }}\n          />\n        </div>\n        <div>\n          <p class=\"caf-demo-title\" onClick={this.focusInput}>\n            点击聚焦\n          </p>\n          <SearchBar placeholder=\"请输入关键词\" ref={c => (this.inpRef = c)} />\n        </div>\n      </div>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./pages/components/search-bar/index.js"],"sourceRoot":""}