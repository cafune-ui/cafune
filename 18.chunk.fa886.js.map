{"version":3,"sources":["webpack:///18.chunk.fa886.js","webpack:///../components/pull-refresh/index.jsx","webpack:///./pages/components/pull-refresh/index.js"],"names":["webpackJsonp","gATp","module","__webpack_exports__","__webpack_require__","_objectWithoutProperties","obj","keys","target","i","indexOf","Object","prototype","hasOwnProperty","call","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","TypeError","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","getDirection","x","y","MIN_DISTANCE","setTransform","offsetY","style","transform","msTransform","MozTransform","webkitTransform","getScrolltop","document","documentElement","scrollTop","window","pageYOffset","body","_objectDestructuringEmpty","pull_refresh__classCallCheck","instance","Constructor","pull_refresh__possibleConstructorReturn","pull_refresh__inherits","defineProperty","_class","_temp2","preact_min","classnames","classnames_default","n","_extends","assign","arguments","length","source","key","PullRefresh","_Component","_temp","_this","_ret","_len","args","Array","_key","this","apply","concat","state","status","height","pullrefresh","createRef","pullrefresh_loading","headHeight","touchStart","event","resetTouchStatus","startX","touches","clientX","startY","clientY","touchMove","touch","deltaX","deltaY","offsetX","Math","abs","direction","onTouchStart","untouchable","getCeiling","onTouchMove","ceiling","setStatus","ease","cancelable","preventDefault","onTouchEnd","props","onRefresh","componentDidMount","current","addEventListener","componentWillUnmount","removeEventListener","disabled","componentWillReceiveProps","nextProps","loading","round","isLoading","setState","render","_ref","prefix","className","children","restProps","cx","ref","Component","defaultProps","d","pull_refresh_GridComp","GridComp","count","setTimeout","console","log","_ref2","pull_refresh","class"],"mappings":"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","file":"18.chunk.fa886.js","sourcesContent":["webpackJsonp([18],{\n\n/***/ \"gATp\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// EXTERNAL MODULE: ./node_modules/preact/dist/preact.min.js\nvar preact_min = __webpack_require__(\"EBst\");\nvar preact_min_default = /*#__PURE__*/__webpack_require__.n(preact_min);\n\n// EXTERNAL MODULE: ../node_modules/classnames/index.js\nvar classnames = __webpack_require__(\"9qb7\");\nvar classnames_default = /*#__PURE__*/__webpack_require__.n(classnames);\n\n// EXTERNAL MODULE: ../node_modules/prop-types/index.js\nvar prop_types = __webpack_require__(\"5D9O\");\nvar prop_types_default = /*#__PURE__*/__webpack_require__.n(prop_types);\n\n// CONCATENATED MODULE: ../components/pull-refresh/index.jsx\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _class, _temp2;\n\n\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\n\n\nvar MIN_DISTANCE = 10;\nfunction getDirection(x, y) {\n  if (x > y && x > MIN_DISTANCE) {\n    return 'horizontal';\n  }\n  if (y > x && y > MIN_DISTANCE) {\n    return 'vertical';\n  }\n  return '';\n}\n\nfunction setTransform(obj, offsetY) {\n  obj.style.transform = 'translate3d(0, ' + offsetY + 'px, 0)';\n  obj.style.msTransform = 'translate3d(0, ' + offsetY + 'px, 0)';\n  obj.style.MozTransform = 'translate3d(0, ' + offsetY + 'px, 0)';\n  obj.style.webkitTransform = 'translate3d(0, ' + offsetY + 'px, 0)';\n}\n\nfunction getScrolltop() {\n  return document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n}\nvar stateMap = {\n  'loosing': '',\n  'pulling': '释放可刷新',\n  'loading': '加载中...'\n  /**\n   * 下拉刷新\n   */\n};var pull_refresh_PullRefresh = (_temp2 = _class = function (_Component) {\n  _inherits(PullRefresh, _Component);\n\n  function PullRefresh() {\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, PullRefresh);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.state = {\n      status: 'normal',\n      height: 0\n    }, _this.pullrefresh = Object(preact_min[\"createRef\"])(), _this.pullrefresh_loading = Object(preact_min[\"createRef\"])(), _this.headHeight = 50, _this.touchStart = function (event) {\n      _this.resetTouchStatus();\n      _this.startX = event.touches[0].clientX;\n      _this.startY = event.touches[0].clientY;\n    }, _this.touchMove = function (event) {\n      var touch = event.touches[0];\n      _this.deltaX = touch.clientX - _this.startX;\n      _this.deltaY = touch.clientY - _this.startY;\n      _this.offsetX = Math.abs(_this.deltaX);\n      _this.offsetY = Math.abs(_this.deltaY);\n      _this.direction = _this.direction || getDirection(_this.offsetX, _this.offsetY);\n    }, _this.resetTouchStatus = function () {\n      _this.direction = '';\n      _this.deltaX = 0;\n      _this.deltaY = 0;\n      _this.offsetX = 0;\n      _this.offsetY = 0;\n    }, _this.onTouchStart = function (event) {\n      // console.log('start')\n      if (!_this.untouchable() && _this.getCeiling()) {\n        _this.touchStart(event);\n      }\n    }, _this.onTouchMove = function (event) {\n      if (_this.untouchable()) {\n        return;\n      }\n      _this.touchMove(event);\n      if (!_this.ceiling && _this.getCeiling()) {\n        _this.startY = event.touches[0].clientY;\n        _this.deltaY = 0;\n      }\n      if (_this.ceiling && _this.deltaY >= 0) {\n        if (_this.direction === 'vertical') {\n          _this.setStatus(_this.ease(_this.deltaY));\n          event.cancelable && event.preventDefault();\n        }\n      }\n    }, _this.onTouchEnd = function () {\n      // console.log('end');\n      if (!_this.untouchable() && _this.ceiling && _this.deltaY) {\n        if (_this.state.status === 'loosing') {\n          _this.props.onRefresh && _this.props.onRefresh();\n          _this.setStatus(_this.headHeight, true);\n        } else {\n          _this.setStatus(0);\n        }\n      }\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  PullRefresh.prototype.componentDidMount = function componentDidMount() {\n    if (this.pullrefresh) {\n      var pullrefresh = this.pullrefresh.current;\n      pullrefresh.addEventListener('touchstart', this.onTouchStart, false);\n      pullrefresh.addEventListener('touchmove', this.onTouchMove, false);\n      pullrefresh.addEventListener('touchend', this.onTouchEnd, false);\n      pullrefresh.addEventListener('touchcancel', this.onTouchEnd, false);\n    }\n  };\n\n  PullRefresh.prototype.componentWillUnmount = function componentWillUnmount() {\n    if (this.pullrefresh) {\n      var pullrefresh = this.pullrefresh.current;\n      pullrefresh.removeEventListener('touchstart', this.onTouchStart, false);\n      pullrefresh.removeEventListener('touchmove', this.onTouchMove, false);\n      pullrefresh.removeEventListener('touchend', this.onTouchEnd, false);\n      pullrefresh.removeEventListener('touchcancel', this.onTouchEnd, false);\n    }\n  };\n\n  PullRefresh.prototype.untouchable = function untouchable() {\n    return this.state.status === 'loading' || this.state.status === 'success' || this.props.disabled;\n  };\n\n  PullRefresh.prototype.getCeiling = function getCeiling() {\n    this.ceiling = getScrolltop() === 0;\n    return this.ceiling;\n  };\n\n  PullRefresh.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    if (!nextProps.loading) {\n      this.setStatus(0);\n    } else {\n      this.setStatus(nextProps.loading ? this.headHeight : 0, nextProps.loading);\n    }\n  };\n\n  PullRefresh.prototype.ease = function ease(height) {\n    var headHeight = this.headHeight;\n\n    return height < headHeight ? height : height < headHeight * 2 ? Math.round(headHeight + (height - headHeight) / 2) : height > headHeight * 1.5 ? headHeight * 1.5 : Math.round(headHeight * 1.5 + (height - headHeight * 2) / 4);\n  };\n\n  PullRefresh.prototype.setStatus = function setStatus(height, isLoading) {\n    setTransform(this.pullrefresh_loading.current, height);\n    var status = isLoading ? 'loading' : height === 0 ? 'normal' : height < this.headHeight ? 'pulling' : 'loosing';\n    if (status !== this.state.status) {\n      this.setState({\n        status: status\n      });\n    }\n  };\n\n  PullRefresh.prototype.render = function render(_ref) {\n    var prefix = _ref.prefix,\n        className = _ref.className,\n        children = _ref.children,\n        restProps = _objectWithoutProperties(_ref, ['prefix', 'className', 'children']);\n\n    return Object(preact_min[\"h\"])(\n      'div',\n      _extends({ className: classnames_default()(prefix, className), ref: this.pullrefresh }, restProps),\n      Object(preact_min[\"h\"])('span', { className: prefix + '-loading', ref: this.pullrefresh_loading }),\n      children\n    );\n  };\n\n  return PullRefresh;\n}(preact_min[\"Component\"]), _class.defaultProps = {\n  prefix: 'caf-pullref'\n}, _temp2);\n\n/* harmony default export */ var pull_refresh = (pull_refresh_PullRefresh);\n// CONCATENATED MODULE: ./pages/components/pull-refresh/index.js\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return pull_refresh_GridComp; });\n\n\n\nfunction _objectDestructuringEmpty(obj) { if (obj == null) throw new TypeError(\"Cannot destructure undefined\"); }\n\nfunction pull_refresh__classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction pull_refresh__possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction pull_refresh__inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n\n\nvar pull_refresh_GridComp = function (_Component) {\n  pull_refresh__inherits(GridComp, _Component);\n\n  function GridComp() {\n    var _temp, _this, _ret;\n\n    pull_refresh__classCallCheck(this, GridComp);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = pull_refresh__possibleConstructorReturn(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.state = {\n      count: 1,\n      loading: false\n    }, _this.onRefresh = function () {\n      setTimeout(function () {\n        console.log('刷新成功');\n        _this.setState({\n          loading: false,\n          count: _this.state.count + 1\n        });\n      }, 2000);\n    }, _temp), pull_refresh__possibleConstructorReturn(_this, _ret);\n  }\n\n  GridComp.prototype.render = function render(_ref, _ref2) {\n    var loading = _ref2.loading,\n        count = _ref2.count;\n\n    _objectDestructuringEmpty(_ref);\n\n    return Object(preact_min[\"h\"])(\n      pull_refresh,\n      { loading: loading, onRefresh: this.onRefresh },\n      Object(preact_min[\"h\"])(\n        'div',\n        { 'class': 'caf-demo-block', style: 'min-height: 500px;' },\n        'count: ',\n        count\n      )\n    );\n  };\n\n  return GridComp;\n}(preact_min[\"Component\"]);\n\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// 18.chunk.fa886.js","import { Component, createRef } from 'preact';\nimport cx from 'classnames';\nimport PropTypes from 'prop-types';\n\nconst MIN_DISTANCE = 10;\nfunction getDirection(x, y) {\n  if (x > y && x > MIN_DISTANCE) {\n    return 'horizontal';\n  }\n  if (y > x && y > MIN_DISTANCE) {\n    return 'vertical';\n  }\n  return '';\n}\n\nfunction setTransform(obj, offsetY) {\n  obj.style.transform = `translate3d(0, ${offsetY}px, 0)`;\n  obj.style.msTransform = `translate3d(0, ${offsetY}px, 0)`;\n  obj.style.MozTransform = `translate3d(0, ${offsetY}px, 0)`;\n  obj.style.webkitTransform = `translate3d(0, ${offsetY}px, 0)`;\n}\n\nfunction getScrolltop() {\n  return  document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n}\nconst stateMap = {\n  'loosing': '',\n  'pulling': '释放可刷新',\n  'loading': '加载中...',\n\n}\n/**\n * 下拉刷新\n */\nclass PullRefresh extends Component {\n  static defaultProps = {\n    prefix: 'caf-pullref'\n  };\n  static propTypes = {\n    /**\n     * 自定义类名\n     */\n    prefix: PropTypes.string,\n    /**\n     * 拉动方向\n     */\n    direction: PropTypes.oneOf(['up', 'down']),\n    /**\n     * 刷新距离\n     */\n    distance: PropTypes.number,\n    /**\n     * 是否处于刷新状态\n     */\n    isRefreshing: PropTypes.bool,\n    /**\n     * 刷新回调\n     */\n    onRefresh: PropTypes.func.isRequired,\n    /**\n     * 刷新指示器\n     */\n    indicator: PropTypes.shape({\n      /**\n       * 下拉中指示器\n       */\n      pulling: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),\n      /**\n       * 释放时指示器\n       */\n      loosing: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),\n      /**\n       * 加载中指示器\n       */\n      loading: PropTypes.oneOfType([PropTypes.string, PropTypes.node]),\n      /**\n       * 刷新结束指示器\n       */\n      finish: PropTypes.oneOfType([PropTypes.string, PropTypes.node])\n    })\n  };\n  state = {\n    status: 'normal',\n    height: 0\n  }\n  pullrefresh = createRef();\n  pullrefresh_loading = createRef();\n  componentDidMount() {\n    if (this.pullrefresh) {\n      const pullrefresh = this.pullrefresh.current;\n      pullrefresh.addEventListener('touchstart', this.onTouchStart, false);\n      pullrefresh.addEventListener('touchmove', this.onTouchMove, false);\n      pullrefresh.addEventListener('touchend', this.onTouchEnd, false);\n      pullrefresh.addEventListener('touchcancel', this.onTouchEnd, false);\n    }\n  }\n  componentWillUnmount() {\n    if (this.pullrefresh) {\n      const pullrefresh = this.pullrefresh.current;\n      pullrefresh.removeEventListener('touchstart', this.onTouchStart, false);\n      pullrefresh.removeEventListener('touchmove', this.onTouchMove, false);\n      pullrefresh.removeEventListener('touchend', this.onTouchEnd, false);\n      pullrefresh.removeEventListener('touchcancel', this.onTouchEnd, false);\n    }\n  }\n  headHeight = 50;\n  touchStart = (event) => {\n    this.resetTouchStatus();\n    this.startX = event.touches[0].clientX;\n    this.startY = event.touches[0].clientY;\n  }\n\n  touchMove = (event) => {\n    const touch = event.touches[0];\n    this.deltaX = touch.clientX - this.startX;\n    this.deltaY = touch.clientY - this.startY;\n    this.offsetX = Math.abs(this.deltaX);\n    this.offsetY = Math.abs(this.deltaY);\n    this.direction = this.direction || getDirection(this.offsetX, this.offsetY);\n  }\n\n  resetTouchStatus = () => {\n    this.direction = '';\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.offsetX = 0;\n    this.offsetY = 0;\n  }\n  untouchable() {\n    return this.state.status === 'loading' || this.state.status === 'success' || this.props.disabled;\n  }\n  onTouchStart = (event) => {\n    // console.log('start')\n    if (!this.untouchable() && this.getCeiling()) {\n      this.touchStart(event);\n    }\n  }\n  onTouchMove = (event) => {\n    if (this.untouchable()) {\n      return;\n    }\n    this.touchMove(event);\n    if (!this.ceiling && this.getCeiling()) {\n      this.startY = event.touches[0].clientY;\n      this.deltaY = 0;\n    }\n    if (this.ceiling && this.deltaY >= 0) {\n      if (this.direction === 'vertical') {\n        this.setStatus(this.ease(this.deltaY));\n        event.cancelable && event.preventDefault();\n      }\n    }\n  }\n  getCeiling() {\n    this.ceiling = getScrolltop() === 0;\n    return this.ceiling;\n  }\n  componentWillReceiveProps(nextProps) {\n    if (!nextProps.loading) {\n      this.setStatus(0);\n    } else {\n      this.setStatus(nextProps.loading ? this.headHeight : 0, nextProps.loading);\n    }\n  }\n  ease(height) {\n    const { headHeight } = this;\n    return height < headHeight\n      ? height\n      : height < headHeight * 2\n        ? Math.round(headHeight + (height - headHeight) / 2)\n        : height > headHeight * 1.5 ? headHeight * 1.5 : Math.round(headHeight * 1.5 + (height - headHeight * 2) / 4);\n  }\n  setStatus(height, isLoading) {\n    setTransform(this.pullrefresh_loading.current, height);\n    const status = isLoading\n      ? 'loading'\n      : height === 0\n        ? 'normal'\n        : height < this.headHeight\n          ? 'pulling'\n          : 'loosing';\n    if (status !== this.state.status) {\n      this.setState({\n        status,\n      })\n    }\n  }\n  onTouchEnd = () => {\n    // console.log('end');\n    if (!this.untouchable() && this.ceiling && this.deltaY) {\n      if (this.state.status === 'loosing') {\n        this.props.onRefresh && this.props.onRefresh();\n        this.setStatus(this.headHeight, true);\n      } else {\n        this.setStatus(0);\n      }\n    }\n  }\n  render({ prefix, className, children, ...restProps }) {\n    return <div className={cx(prefix, className)} ref={ this.pullrefresh } {...restProps}>\n      <span className={`${prefix}-loading`} ref={ this.pullrefresh_loading }></span>\n      { children }\n    </div>\n  }\n}\nexport default PullRefresh;\n\n\n\n// WEBPACK FOOTER //\n// ../components/pull-refresh/index.jsx","import { PullRefresh } from 'cafune';\nimport { Component } from 'preact';\n\nexport default class GridComp extends Component {\n  state = {\n    count: 1,\n    loading: false\n  };\n  onRefresh = () => {\n    setTimeout(() => {\n      console.log('刷新成功');\n      this.setState({\n        loading: false,\n        count: this.state.count + 1\n      });\n    }, 2000);\n  };\n  render({}, { loading, count }) {\n    return (\n      <PullRefresh loading={loading} onRefresh={this.onRefresh}>\n        <div class=\"caf-demo-block\" style=\"min-height: 500px;\">\n          count: {count}\n        </div>\n      </PullRefresh>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./pages/components/pull-refresh/index.js"],"sourceRoot":""}